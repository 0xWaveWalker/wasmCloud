{{#if create_actor ~}}
# Makefile for {{project_name}} (Actor project)

COLOR ?= always # Valid COLOR options: {always, auto, never}
CARGO = cargo --color $(COLOR)
TARGET = target/wasm32-unknown-unknown
DEBUG = $(TARGET)/debug
RELEASE = $(TARGET)/release
KEYDIR ?= .keys
VERSION = $(shell cargo metadata --no-deps --format-version 1 | jq -r '.packages[] .version' | head -1)
REVISION = 0

NAME = {{ to_snake_case project_name }}

.PHONY: all build clean test release actor_id run

all: release

clean:
	cargo clean
	rm -rf build

release:
	@$(CARGO) build --release
	wash claims sign $(RELEASE)/$(NAME).wasm -c wasmcloud:httpserver --name $(NAME) --ver $(VERSION) --rev $(REVISION)

actor_id: release
	wash claims inspect $(RELEASE)/$(NAME)_s.wasm -o json | jq .module | tr -d "\""

run:
	ACTOR_ID=$(shell make actor_id 2>&1 | tail -1) \
		RUST_BACKTRACE=1 RUST_LOG=debug wasmcloud -m manifest.yaml

test: build
	cargo test

{{/if ~}}
{{#if create_provider ~}}

all:
	@echo NOT IMPLEMENTED

{{/if ~}}
{{#if create_interface ~}}
# Makefile for {{ namespace }} - rust library

build:
	cargo build

release:
	cargo build --release

clean:
	cargo clean

{{/if }}